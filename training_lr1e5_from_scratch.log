================================================================
π€ μµμ ν™”λ ν•κµ­μ–΄ GPT ν•™μµ - RTX 4090 24GB
================================================================

π“ ν•μ΄νΌνλΌλ―Έν„° (IndexTTS2 λ…Όλ¬Έ κΈ°λ°):
  - GPU: RTX 4090 24GB
  - Batch Size: 8 (λ©”λ¨λ¦¬ μ•μ „)
  - Gradient Accumulation: 8 (μ‹¤ν¨ batch 64)
  - Tokens/Batch: ~34,694 (Transformer λ…Όλ¬Έ μμ¤€)
  - Learning Rate: 2e-4 (λ…Όλ¬Έ κ¶μ¥κ°’)
  - Warmup Steps: 30,000
  - Epochs: 2
  - Gradient Clip: 0.5

π’΅ Gradient Accumulation μ‚¬μ©:
  - λ©”λ¨λ¦¬λ” batch 8 μμ¤€ μ μ§€ (μ•μ „)
  - ν•™μµ ν¨κ³Όλ” batch 64μ™€ λ™μΌ
  - Transformer λ…Όλ¬Έ κΈ°μ¤€(~25k tokens) λ‹¬μ„± β…

π― λ©ν‘:
  - text_loss < 0.9
  - mel_loss < 3.5
  - ν•™μµ μ‹κ°„: ~30-35μ‹κ°„

π“ μ°Έκ³ λ¬Έν—:
  - IndexTTS2 (arXiv:2506.21619v2) - LR 2e-4, AdamW
  - Attention is All You Need (Vaswani+ 2017) - ~25k tokens/batch
  - Decoupled Weight Decay (Loshchilov+ 2019) - AdamW optimizer

β οΈ  μ£Όμμ‚¬ν•­:
  - ν„μ¬: 1-stage ν•™μµ (ConformerEncoder + PerceiverResampler)
  - λ…Όλ¬Έ: 3-stage ν•™μµ (basic β†’ GRL emotion β†’ fine-tune)
  - GRL λ―Έκµ¬ν„μΌλ΅ speaker-emotion disentanglement μ ν•μ 
  - Phase 1 baseline ν™•λ³΄ ν›„ GRL μ¶”κ°€ μμ •

================================================================
β… GPU: NVIDIA GeForce RTX 4090
β… VRAM: 24564MB



π¬ ν•™μµμ„ μ‹μ‘ν•©λ‹λ‹¤...
π“ TensorBoard: http://localhost:6006
π“ μ²΄ν¬ν¬μΈνΈ: /mnt/sda1/models/index-tts-ko/checkpoints/

π’΅ Gradient Accumulation ν™μ„±ν™”:
   - Forward/Backward 8ν μ‹¤ν–‰ ν›„ 1ν μ—…λ°μ΄νΈ
   - μ•½κ°„ λλ¦¬μ§€λ§ Transformer λ…Όλ¬Έ κΈ°μ¤€ λ‹¬μ„±

[KO-STEP4] train manifests=--train-manifest /mnt/sda1/emilia-yodas/KO_preprocessed/gpt_pairs_train.jsonl::ko
[KO-STEP4] val manifests=--val-manifest /mnt/sda1/emilia-yodas/KO_preprocessed/gpt_pairs_val.jsonl::ko
[KO-STEP4] output-dir=/mnt/sda1/models/index-tts-ko/checkpoints
β… Best checkpoint monitor started (PID: 2905665)
   Log: /tmp/best_ckpt_monitor.log

2025-11-20 12:48:46,247 WETEXT INFO found existing fst: /mnt/sdc1/ws/workspace/monorepo/external/index-tts/indextts/utils/tagger_cache/zh_tn_tagger.fst
2025-11-20 12:48:46,247 WETEXT INFO                     /mnt/sdc1/ws/workspace/monorepo/external/index-tts/indextts/utils/tagger_cache/zh_tn_verbalizer.fst
2025-11-20 12:48:46,247 WETEXT INFO skip building fst for zh_normalizer ...
2025-11-20 12:48:46,402 WETEXT INFO found existing fst: /mnt/sdc1/ws/workspace/.venv_indextts/lib/python3.10/site-packages/tn/en_tn_tagger.fst
2025-11-20 12:48:46,403 WETEXT INFO                     /mnt/sdc1/ws/workspace/.venv_indextts/lib/python3.10/site-packages/tn/en_tn_verbalizer.fst
2025-11-20 12:48:46,403 WETEXT INFO skip building fst for en_normalizer ...
/mnt/sdc1/ws/workspace/.venv_indextts/lib/python3.10/site-packages/transformers/configuration_utils.py:312: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
[Info] Aim initialized: experiment=indextts-korean, run=run_20251120_124845
[Info] View results: aim up --repo .aim
[Info] Remapped text_embedding.weight: copied 61 shared tokens.
[Info] Remapped text_head.weight: copied 61 shared tokens.
[Info] Remapped text_head.bias: copied 61 shared tokens.
[Info] Loading training manifests...
[Info] Parsing manifest /mnt/sda1/emilia-yodas/KO_preprocessed/gpt_pairs_train.jsonl ...
  β€Ά processed 10,000 entries (kept 10,000) in gpt_pairs_train.jsonl
  β€Ά processed 20,000 entries (kept 20,000) in gpt_pairs_train.jsonl
  β€Ά processed 30,000 entries (kept 30,000) in gpt_pairs_train.jsonl
  β€Ά processed 40,000 entries (kept 40,000) in gpt_pairs_train.jsonl
  β€Ά processed 50,000 entries (kept 50,000) in gpt_pairs_train.jsonl
  β€Ά processed 60,000 entries (kept 60,000) in gpt_pairs_train.jsonl
  β€Ά processed 70,000 entries (kept 70,000) in gpt_pairs_train.jsonl
  β€Ά processed 80,000 entries (kept 80,000) in gpt_pairs_train.jsonl
  β€Ά processed 90,000 entries (kept 90,000) in gpt_pairs_train.jsonl
  β€Ά processed 100,000 entries (kept 100,000) in gpt_pairs_train.jsonl
  β€Ά processed 110,000 entries (kept 110,000) in gpt_pairs_train.jsonl
  β€Ά processed 120,000 entries (kept 120,000) in gpt_pairs_train.jsonl
  β€Ά processed 130,000 entries (kept 130,000) in gpt_pairs_train.jsonl
  β€Ά processed 140,000 entries (kept 140,000) in gpt_pairs_train.jsonl
  β€Ά processed 150,000 entries (kept 150,000) in gpt_pairs_train.jsonl
  β€Ά processed 160,000 entries (kept 160,000) in gpt_pairs_train.jsonl
  β€Ά processed 170,000 entries (kept 170,000) in gpt_pairs_train.jsonl
  β€Ά processed 180,000 entries (kept 180,000) in gpt_pairs_train.jsonl
  β€Ά processed 190,000 entries (kept 190,000) in gpt_pairs_train.jsonl
  β€Ά processed 200,000 entries (kept 200,000) in gpt_pairs_train.jsonl
  β€Ά processed 210,000 entries (kept 210,000) in gpt_pairs_train.jsonl
  β€Ά processed 220,000 entries (kept 220,000) in gpt_pairs_train.jsonl
  β€Ά processed 230,000 entries (kept 230,000) in gpt_pairs_train.jsonl
  β€Ά processed 240,000 entries (kept 240,000) in gpt_pairs_train.jsonl
  β€Ά processed 250,000 entries (kept 250,000) in gpt_pairs_train.jsonl
  β€Ά processed 260,000 entries (kept 260,000) in gpt_pairs_train.jsonl
  β€Ά processed 270,000 entries (kept 270,000) in gpt_pairs_train.jsonl
  β€Ά processed 280,000 entries (kept 280,000) in gpt_pairs_train.jsonl
  β€Ά processed 290,000 entries (kept 290,000) in gpt_pairs_train.jsonl
  β€Ά processed 300,000 entries (kept 300,000) in gpt_pairs_train.jsonl
  β€Ά processed 310,000 entries (kept 310,000) in gpt_pairs_train.jsonl
  β€Ά processed 320,000 entries (kept 320,000) in gpt_pairs_train.jsonl
  β€Ά processed 330,000 entries (kept 330,000) in gpt_pairs_train.jsonl
  β€Ά processed 340,000 entries (kept 340,000) in gpt_pairs_train.jsonl
  β€Ά processed 350,000 entries (kept 350,000) in gpt_pairs_train.jsonl
  β€Ά processed 360,000 entries (kept 360,000) in gpt_pairs_train.jsonl
  β€Ά processed 370,000 entries (kept 370,000) in gpt_pairs_train.jsonl
  β€Ά processed 380,000 entries (kept 380,000) in gpt_pairs_train.jsonl
  β€Ά processed 390,000 entries (kept 390,000) in gpt_pairs_train.jsonl
  β€Ά processed 400,000 entries (kept 400,000) in gpt_pairs_train.jsonl
  β€Ά processed 410,000 entries (kept 410,000) in gpt_pairs_train.jsonl
  β€Ά processed 420,000 entries (kept 420,000) in gpt_pairs_train.jsonl
  β€Ά processed 430,000 entries (kept 430,000) in gpt_pairs_train.jsonl
  β€Ά processed 440,000 entries (kept 440,000) in gpt_pairs_train.jsonl
  β€Ά processed 450,000 entries (kept 450,000) in gpt_pairs_train.jsonl
  β€Ά processed 460,000 entries (kept 460,000) in gpt_pairs_train.jsonl
  β€Ά processed 470,000 entries (kept 470,000) in gpt_pairs_train.jsonl
  β€Ά processed 480,000 entries (kept 480,000) in gpt_pairs_train.jsonl
  β€Ά processed 490,000 entries (kept 490,000) in gpt_pairs_train.jsonl
  β€Ά processed 500,000 entries (kept 500,000) in gpt_pairs_train.jsonl
  β€Ά processed 510,000 entries (kept 510,000) in gpt_pairs_train.jsonl
  β€Ά processed 520,000 entries (kept 520,000) in gpt_pairs_train.jsonl
  β€Ά processed 530,000 entries (kept 530,000) in gpt_pairs_train.jsonl
  β€Ά processed 540,000 entries (kept 540,000) in gpt_pairs_train.jsonl
  β€Ά processed 550,000 entries (kept 550,000) in gpt_pairs_train.jsonl
  β€Ά processed 560,000 entries (kept 560,000) in gpt_pairs_train.jsonl
  β€Ά processed 570,000 entries (kept 570,000) in gpt_pairs_train.jsonl
  β€Ά processed 580,000 entries (kept 580,000) in gpt_pairs_train.jsonl
  β€Ά processed 590,000 entries (kept 590,000) in gpt_pairs_train.jsonl
  β€Ά processed 600,000 entries (kept 600,000) in gpt_pairs_train.jsonl
  β€Ά processed 610,000 entries (kept 610,000) in gpt_pairs_train.jsonl
  β€Ά processed 620,000 entries (kept 620,000) in gpt_pairs_train.jsonl
  β€Ά processed 630,000 entries (kept 630,000) in gpt_pairs_train.jsonl
  β€Ά processed 640,000 entries (kept 640,000) in gpt_pairs_train.jsonl
  β€Ά processed 650,000 entries (kept 650,000) in gpt_pairs_train.jsonl
  β€Ά processed 660,000 entries (kept 660,000) in gpt_pairs_train.jsonl
  β€Ά processed 670,000 entries (kept 670,000) in gpt_pairs_train.jsonl
  β€Ά processed 680,000 entries (kept 680,000) in gpt_pairs_train.jsonl
  β€Ά processed 690,000 entries (kept 690,000) in gpt_pairs_train.jsonl
  β€Ά processed 700,000 entries (kept 700,000) in gpt_pairs_train.jsonl
  β€Ά processed 710,000 entries (kept 710,000) in gpt_pairs_train.jsonl
  β€Ά processed 720,000 entries (kept 720,000) in gpt_pairs_train.jsonl
  β€Ά processed 730,000 entries (kept 730,000) in gpt_pairs_train.jsonl
  β€Ά processed 740,000 entries (kept 740,000) in gpt_pairs_train.jsonl
  β€Ά processed 750,000 entries (kept 750,000) in gpt_pairs_train.jsonl
  β€Ά processed 760,000 entries (kept 760,000) in gpt_pairs_train.jsonl
  β€Ά processed 770,000 entries (kept 770,000) in gpt_pairs_train.jsonl
  β€Ά processed 780,000 entries (kept 780,000) in gpt_pairs_train.jsonl
  β€Ά processed 790,000 entries (kept 790,000) in gpt_pairs_train.jsonl
  β€Ά processed 800,000 entries (kept 800,000) in gpt_pairs_train.jsonl
  β€Ά processed 810,000 entries (kept 810,000) in gpt_pairs_train.jsonl
  β€Ά processed 820,000 entries (kept 820,000) in gpt_pairs_train.jsonl
  β€Ά processed 830,000 entries (kept 830,000) in gpt_pairs_train.jsonl
  β€Ά processed 840,000 entries (kept 840,000) in gpt_pairs_train.jsonl
  β€Ά processed 850,000 entries (kept 850,000) in gpt_pairs_train.jsonl
  β€Ά processed 860,000 entries (kept 860,000) in gpt_pairs_train.jsonl
  β€Ά processed 870,000 entries (kept 870,000) in gpt_pairs_train.jsonl
  β€Ά processed 880,000 entries (kept 880,000) in gpt_pairs_train.jsonl
  β€Ά processed 890,000 entries (kept 890,000) in gpt_pairs_train.jsonl
  β€Ά processed 900,000 entries (kept 900,000) in gpt_pairs_train.jsonl
  β€Ά processed 910,000 entries (kept 910,000) in gpt_pairs_train.jsonl
  β€Ά processed 920,000 entries (kept 920,000) in gpt_pairs_train.jsonl
  β€Ά processed 930,000 entries (kept 930,000) in gpt_pairs_train.jsonl
  β€Ά processed 940,000 entries (kept 940,000) in gpt_pairs_train.jsonl
  β€Ά processed 950,000 entries (kept 950,000) in gpt_pairs_train.jsonl
  β€Ά processed 960,000 entries (kept 960,000) in gpt_pairs_train.jsonl
  β€Ά processed 970,000 entries (kept 970,000) in gpt_pairs_train.jsonl
  β€Ά processed 980,000 entries (kept 980,000) in gpt_pairs_train.jsonl
  β€Ά processed 990,000 entries (kept 990,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,000,000 entries (kept 1,000,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,010,000 entries (kept 1,010,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,020,000 entries (kept 1,020,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,030,000 entries (kept 1,030,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,040,000 entries (kept 1,040,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,050,000 entries (kept 1,050,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,060,000 entries (kept 1,060,000) in gpt_pairs_train.jsonl
  β€Ά processed 1,070,000 entries (kept 1,070,000) in gpt_pairs_train.jsonl
μΆ…λ£λ¨
